X = linspace(-15, 15, 16)';
 X2 = linspace(-7, 7, 8);
% Y3 = [1.00000000e+00 1.00000000e-10 1.00000000e-10 8.04472845e-02       1.00000000e-10 9.98718569e-01 1.00000000e-10 1.00000000e-10       1.00000000e-10 1.00000000e-10 9.98718569e-01 1.00000000e-10      8.04472845e-02 1.00000000e-10 1.00000000e-10 1.00000000e+00];
% Y2 = [ 6.30334488e-01 1.00000000e-10 6.91178911e-03 1.00000000e-10       1.00000000e-10 6.91178911e-03 1.00000000e-10 6.30334488e-01];
% Y1 = [2.20795525e-03 1.00000000e-10 1.00000000e-10 1.00000000e+00       1.00000000e-10 1.00000000e-10 1.00000000e-10 1.00000000e-10       1.00000000e-10 1.00000000e-10 1.00000000e-10 1.00000000e-10       1.00000000e+00 1.00000000e-10 1.00000000e-10 2.20795525e-03];
% % Y4 = [5.49827702e-01 1.00000000e-10 1.00000000e+00 4.23572176e-02       4.23572176e-02 1.00000000e+00 1.00000000e-10 5.49827702e-01];
% Y4 = [7.31650087e-01 1.00001920e-10 6.74040686e-01 4.86756592e-02   4.86756592e-02 6.74040686e-01 1.00001920e-10 7.31650087e-01];
% 90
% Y1 = [1.96039705e-06 1.00000000e-10 1.97555502e-01 4.27585824e-05       1.00000000e+00 8.74753220e-05 2.32890440e-06 1.06059134e-06       1.05743909e-04 1.00000000e+00 3.80444260e-04 1.71611539e-04       1.00000000e-10 1.00000000e-10 9.47986327e-07 1.00000000e+00];
%94   
Y3= [3.45744939e-02 3.78692396e-01 2.62891583e-01 1.02749458e-01       1.61783502e-01 2.39516922e-01 3.95461545e-01 8.18767870e-01       8.69863343e-01 9.37287857e-01 5.82076212e-01 5.90644209e-01       6.69786982e-01 7.06079935e-01 4.62951130e-01 1.49310711e-01];
% Y3=[1.17105841e-01 4.52528242e-01 6.06379632e-01 6.21970686e-01       5.88371032e-01 7.26228528e-01 6.35698905e-01 3.47826112e-01       2.90475909e-01 2.81446554e-01 4.64757247e-01 4.12646958e-01       5.03507735e-01 3.99591139e-01 4.49389730e-01 3.59367948e-01];%50
% Y3 = [1.00000000e+00 1.00000000e-10 1.00000000e-10 1.00000000e-10       1.00000000e+00 1.00000000e+00 1.00000000e-10 1.00000000e+00       1.00000000e-10 1.00000000e-10 1.00000000e+00 3.87190573e-01       1.00000000e-10 1.00000000e+00 6.73799546e-02 1.00000000e+00];
% Y1 = [       8.95340519e-01 6.80116674e-01 6.40534748e-01 4.69732458e-01       3.80327625e-01 8.22300948e-01 6.82488496e-01 5.51239218e-01       9.30656690e-01 7.38905980e-01 1.00000000e+00 8.65613456e-01       8.17133631e-01 8.96796204e-01 7.78212248e-01 7.94015278e-01]   %54
% Y1=[       7.44590916e-01 1.00000000e-10 1.00000000e-10 7.35333785e-02       1.00000000e-10 1.00000000e-10 1.00000000e-10 1.00000000e-10       1.00000000e-10 1.00000000e-10 1.00000000e-10 3.16596054e-01       1.00000000e-10 8.87484007e-02 1.00000000e-10 9.49130263e-01];
Y1= [1.00000000e+00 1.00000000e-10 1.00000000e-10 1.00000000e-10       1.00000000e-10 1.00000000e-10 3.48379206e-01 1.00000000e-10       1.00000000e-10 1.00000000e+00 1.00000000e-10 1.00000000e-10       1.00000000e-10 3.33199413e-01 1.00000000e-10 1.00000000e-10];
% Y1=[       5.72664867e-01 4.32256475e-01 2.70362831e-02 3.66694127e-01
%        1.00000000e+00 9.99996940e-01 6.57483399e-01 5.06796603e-01
%        5.35105438e-01 5.00287426e-01 6.95338619e-01 9.65905229e-01,
%        1.00000000e+00 9.95510017e-01 8.30244017e-01 3.02297107e-01];
% Y1 = [1.00000000e+00 1.00000000e-10 1.00000000e-10 1.00000000e-10       1.00000000e+00 1.00000000e+00 1.00000000e-10 1.00000000e+00       1.00000000e-10 1.00000000e-10 1.00000000e+00 3.87190573e-01       1.00000000e-10 1.00000000e+00 6.73799546e-02 1.00000000e+00]; %44
%85

Y2 = [4.97188342e-01, 5.01788241e-11, 5.01788241e-11, 1.02275670e-03,       6.59979449e-07, 5.01788241e-11, 5.01788241e-11, 5.01788241e-01]; %36
% Y2 = [2.46991919e-01, 5.73701786e-01, 8.06243657e-01, 8.78913345e-01,       7.20075783e-01, 3.61226049e-01, 1.34532433e-01, 7.91204413e-02]
% Y2 = [1.66741273e-01 3.75321148e-01 7.18623344e-01 9.70973652e-01       8.47948941e-01 9.12458716e-01 7.24406389e-01 3.95353493e-01];
%92   
Y4 = [3.62546122e-01 6.51652910e-01 9.99991791e-01 9.99988140e-01       9.99193231e-01 7.60515580e-01 5.47511639e-01 3.02252505e-01];



%30 45
% Y1=[9.81118972e-01 9.81118972e-11 9.81118972e-11 9.81118972e-11       9.81118972e-11 9.81118972e-11 9.81118972e-11 9.81118972e-11       9.81118972e-11 9.81118972e-11 9.81118972e-11 9.99011763e-07       9.81118972e-11 9.81118972e-11 9.81118972e-11 1.88800282e-02]; 
% Y3= [1.00000000e+00 1.00000000e-10 1.00000000e-10 1.00000000e-10       1.00000000e-10 1.00000000e-10 1.41865680e-04 1.00000000e-10       1.00000000e-10 9.27350840e-09 1.00000000e-10 1.00000000e-10       2.14156113e-10 1.00000000e-10 1.00000000e-10 5.81557135e-01];
% Y5=[2.17275544e-06 1.93595186e-06 1.00000000e-10 1.00000000e-10       1.00000000e-10 4.76492762e-06 3.13725052e-01 2.57097528e-06       3.89657702e-07 2.79363091e-06 1.19363887e-06 1.00000000e+00       4.04895194e-06 2.21114117e-06 1.00000000e-10  3.00004549e-06];
% Y2=[1.35509375e-02 9.86449062e-11 9.86449062e-11 9.86449062e-11       9.86449062e-11 9.86449062e-11 9.86449062e-11 9.86449062e-01];
% Y4=[1.00000000e+00 1.00000000e-10 1.00000000e-10, 1.00000000e-10       1.00000000e-10 1.00000000e-10 1.00000000e-10 1.00000000e+00];
% Y6=[1.00000000e-10 1.00000000e-10 1.00000000e+00 1.00000000e-10       1.00000000e-10 1.00000000e-10 9.87949155e-01 1.00000000e-10];
% 45[1.71318351e-01 1.79241050e-01 2.32474875e-01 1.50877057e-01       4.22108316e-01 1.48800888e-01 4.44283961e-01 2.20668721e-01       2.14670476e-01 3.85745151e-01 8.93877544e-01 8.53742215e-01       7.66663866e-01 6.78780475e-01 7.89495948e-01 5.09593672e-01       ]
%45[5.81260779e-01 8.72164062e-01 9.32483474e-01 9.78832616e-01       9.93861811e-01 8.69634904e-01 6.96783379e-01 3.28476979e-01];

Y1=[3.68775241e-07  2.02186142e-02  1.09304421e-07  2.85658083e-07        5.05910605e-07  5.52367438e-07  3.59733855e-07  3.68025720e-07        2.70918142e-08  4.03909513e-07  1.67215113e-07 6.58852241e-01        1.00000000e-11  2.51945075e-07  1.00000000e-11  1.52775945e-03]; 
Y3= [1.00000000e+00,  1.00000000e-11,  1.00000000e-11,  5.34810186e-01,        1.00000000e-11,  4.15979112e-01,  1.00000000e-11,  1.00000000e-11,        1.00000000e-11,  4.98696549e-01,  1.00000000e-11,  5.62002413e-01,        1.00000000e-11,  1.00000000e-11,  1.00000000e-11,  1.00000000e+00];
Y5=[  0.4756113         0.72057101  0.65685695  0.5151107   0.76281968  0.59543545        0.77191521  0.90576328  0.75522408  0.70258242  0.41285089        0.56868744  0.66593929  0.98239608  0.03574857  0.8507241 ];
Y2=[8.90785528e-01,  1.00000000e-11,  2.08062394e-03,  1.00000000e-11,        7.17606114e-10,  2.10056176e-02,  1.73080060e-04,  1.00000000e+00];
Y4=[0.06382327,        0.29297325,  0.44856928,  0.45741012,  0.98299928,  1.        ,        0.88698731,  1.  ];
% Y6=[  0.73554812,        0.66552722,  0.62156063,  0.58936313,  0.66900642,  0.74228327,        0.70457728,  0.62911722 ];
Y6= [3.62546122e-01, 6.51652910e-01, 9.99991791e-01, 9.99988140e-01,       9.99193231e-01, 7.60515580e-01, 5.47511639e-01, 3.02252505e-01];
Y1 = Y1 /sum(Y1);
Y2 = Y2 /sum(Y2);
Y3 = Y3 /sum(Y3);
Y4 = Y4 /sum(Y4);
Y5 = Y5 /sum(Y5);
Y6 = Y6 /sum(Y6);

% Create figure
figure1 = figure;


% Change default axes fonts.
set(0,'DefaultAxesFontName', 'Times New Roman')
set(0,'DefaultAxesFontSize', 14)
% Create subplot 1
subplot1 = subplot(3,1,2,'Parent',figure1);
hold(subplot1,'on');
stem(X,Y3,'filled')
xlabel('Constellation point') 
xticks([-15 -13 -11 -9 -7 -5 -3 -1 1 3 5 7 9 11 13 15])
xticklabels({'-15','-13' ,'-11', '-9', '-7', '-5', '-3', '-1', '1', '3', '5', '7', '9', '11', '13', '15'})
ylabel('Probability') 
title({' \rm \it P_t \rm= 35 dBm'});
box on
grid on

subplot1 = subplot(3,1,3,'Parent',figure1);
hold(subplot1,'on');
stem(X,Y5,'filled')
xlabel('Constellation point') 
xticks([-15 -13 -11 -9 -7 -5 -3 -1 1 3 5 7 9 11 13 15])
xticklabels({'-15','-13' ,'-11', '-9', '-7', '-5', '-3', '-1', '1', '3', '5', '7', '9', '11', '13', '15'})
ylabel('Probability') 
title({' \rm \it P_t \rm=40 dBm'});
box on
grid on
subplot1 = subplot(3,1,1,'Parent',figure1);
hold(subplot1,'on');
box on
grid on
stem(X,Y1,'filled')
xlabel('Constellation point') 
xticks([-15 -13 -11 -9 -7 -5 -3 -1 1 3 5 7 9 11 13 15])
xticklabels({'-15', '-13','-11', '-9', '-7', '-5', '-3', '-1', '1', '3', '5', '7', '9', '11', '13', '15'})
ylabel('Probability') 

title({'\rm \it P_t\rm = 30 dBm'});





figure1 = figure;
box on
grid on
set(0,'DefaultAxesFontName', 'Times New Roman')
set(0,'DefaultAxesFontSize', 14)

subplot1 = subplot(3,1,1,'Parent',figure1);
hold(subplot1,'on');
stem(X2,Y2,'filled')
xlim([-7 7])
xlabel('Constellation point') 
xticks([-7 -5 -3 -1 1 3 5 7])
xticklabels({' -7', '-5','-3', '-1', '1', '3', '5', '7'})
ylabel('Probability') 
title({' \rm \it P_t\rm = 30 dBm'});
box on
grid on

% Create subplot 2
subplot1 = subplot(3,1,2,'Parent',figure1);
hold(subplot1,'on');
box on
grid on
xlim([-7 7])
stem(X2,Y4,'filled')
xlabel('Constellation point') 
xticks([-7 -5 -3 -1 1 3 5 7])
xticklabels({' -7', '-5','-3', '-1', '1', '3', '5', '7'})
ylabel('Probability') 
title({'\rm \it  P_t \rm= 35 dBm'});
grid on
subplot1 = subplot(3,1,3,'Parent',figure1);
hold(subplot1,'on');
xlim([-7 7])
stem(X2,Y6,'filled')
grid on
box on
xlabel('Constellation point') 
xticks([-7 -5 -3 -1 1 3 5 7])
xticklabels({' -7', '-5','-3', '-1', '1', '3', '5', '7'})
ylabel('Probability') 
title({' \rm \it P_t \rm=40 dBm'});
