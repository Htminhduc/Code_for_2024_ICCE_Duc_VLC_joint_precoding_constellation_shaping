power =[10 15 20 25 30 35 40 45];
power2 = linspace(30, 55, 20)';
power4 = linspace(30, 55,19);
power3 = linspace(10, 107, 10)';

%_full_precoder_PCS_BER
sc_8_full_precoder_PCS_BER  =[1.06203578855088057 1.3098282853966886 1.6138554399575504  1.8707557454517096 2.0707557454517096 2.232345910433167 2.456814657742355 3.0007344150943114 2.9995989882987906 2.999252752606183 3.000745419563752 3.00120786683246 3.0002256044612143 3.001307513713516 3.000421813649949 3.0007077345910913 3.0007309301587695  3.000978763778926 3.0003037596040723 2.9999220766862393];
ber_8_full_precoder_PCS_BER =[0.0037999009907509827 0.0037999175457725707 0.0037999175457725707 0.0037999175457725707  0.0037987715866857424 0.0037987715866857424  0.0037987715866857424 0.0022579731648543918 0.00023282548361632405 7.122955179321993e-06 3.1365076570890996e-08 6.580489343315069e-12 1.0913460823251749e-17 8.620172778333431e-27 3.6658281481748377e-41 6.994936466098275e-64 7.806821087539599e-100 9.404251911798436e-157 6.599752153213219e-247 0.0];
sc_16_full_precoder_PCS_BER =[0 0 0 0 0 1.8251954955124834 2.158708337549013 2.458708337549013 2.98216089124173 3.362058129437629 3.9983527199378313 3.997130595846011  3.999154866756651 4.000184200255106 3.9998437614531728 4.002997989494856 3.9989629576212864 3.9997780491591204  3.9997624687474773 3.9992056232335047];
ber_16_full_precoder_PCS_BER=[0.036827201018327184 0.0708008153684416  0.025639775253654233  0.05132044431680988 0.02896145402546188 0.0037994501280689866 0.003799807044591788  0.003799807044591788 0.003799807044591788 0.003793757333556025 0.003073428598154997 0.00042327695994416955 1.9982913519050125e-05 1.7678031181466463e-07 1.1072626789335092e-10 1.0513600481057213e-15  1.3067195830963534e-23 4.41046671740787e-36 8.594611925807303e-56  5.634627481861198e-87];

%Full precode PCS NOBER
sc_8_full_precoder_PCS_NOBER  =[1.06203578855088057 1.3098282853966886 1.6138554399575504  1.8707557454517096 2.0707557454517096 2.232345910433167 2.456814657742355 3.0007344150943114 2.9995989882987906 2.999252752606183 3.000745419563752 3.00120786683246 3.0002256044612143 3.001307513713516 3.000421813649949 3.0007077345910913 3.0007309301587695  3.000978763778926 3.0003037596040723 2.9999220766862393];
ber_8_full_precoder_PCS_NOBER =[0.0037999009907509827 0.0037999175457725707 0.0037999175457725707 0.0037999175457725707  0.0037987715866857424 0.0037987715866857424  0.0037987715866857424 0.0022579731648543918 0.00023282548361632405 7.122955179321993e-06 3.1365076570890996e-08 6.580489343315069e-12 1.0913460823251749e-17 8.620172778333431e-27 3.6658281481748377e-41 6.994936466098275e-64 7.806821087539599e-100 9.404251911798436e-157 6.599752153213219e-247 0.0];
sc_16_full_precoder_PCS_NOBER =[0 0 0 0 0 1.8251954955124834 2.158708337549013 2.458708337549013 2.98216089124173 3.362058129437629 3.9983527199378313 3.997130595846011  3.999154866756651 4.000184200255106 3.9998437614531728 4.002997989494856 3.9989629576212864 3.9997780491591204  3.9997624687474773 3.9992056232335047];
ber_16_full_precoder_PCS_NOBER=[0.036827201018327184 0.0708008153684416  0.025639775253654233  0.05132044431680988 0.02896145402546188 0.0037994501280689866 0.003799807044591788  0.003799807044591788 0.003799807044591788 0.003793757333556025 0.003073428598154997 0.00042327695994416955 1.9982913519050125e-05 1.7678031181466463e-07 1.1072626789335092e-10 1.0513600481057213e-15  1.3067195830963534e-23 4.41046671740787e-36 8.594611925807303e-56  5.634627481861198e-87];

%Precode UNI BER
sc_8_uni_BER  =[0 0 0 0 3.0000000000000018];
ber_8_uni_BER =[0.0037999009907509827 0.0037999175457725707 0.0037999175457725707 0.0037999175457725707  0.0037987715866857424 0.0037987715866857424  0.0037987715866857424 0.0022579731648543918 0.00023282548361632405 7.122955179321993e-06 3.1365076570890996e-08 6.580489343315069e-12 1.0913460823251749e-17 8.620172778333431e-27 3.6658281481748377e-41 6.994936466098275e-64 7.806821087539599e-100 9.404251911798436e-157 6.599752153213219e-247 0.0];
sc_16_uni_BER =[0 0 0 0 0 0 0 0 0 0 4 4 4 4 4 4 4 4 4 4];
ber_16_uni_BER=[0 0 0 0 0 0 0 0 0 0 0 0.00370655158216107  0.0035236325777362595 0.0010410100708115096  6.30877365235986e-05 0.00012130597764284432 2.0349805658942916e-08 1.8247157233022165e-05 1.529986540000907e-05 1.529986540000907e-05 9.105779871152948e-07 3.030847410001596e-36];

% Precode UNI noBER
sc_8_uni_NOBER  =[0 0 0 0 3.0000000000000018];
ber_8_uni_NOBER =[0.0037999009907509827 0.0037999175457725707 0.0037999175457725707 0.0037999175457725707  0.0037987715866857424 0.0037987715866857424  0.0037987715866857424 0.0022579731648543918 0.00023282548361632405 7.122955179321993e-06 3.1365076570890996e-08 6.580489343315069e-12 1.0913460823251749e-17 8.620172778333431e-27 3.6658281481748377e-41 6.994936466098275e-64 7.806821087539599e-100 9.404251911798436e-157 6.599752153213219e-247 0.0];
sc_16_uni_NOBER =[0 0 0 0 0 0 0 0 0 0 4 4 4 4 4 4 4 4 4 4];
ber_16_uni_NOBER=[0 0 0 0 0 0 0 0 0 0 0 0.00370655158216107  0.0035236325777362595 0.0010410100708115096  6.30877365235986e-05 0.00012130597764284432 2.0349805658942916e-08 1.8247157233022165e-05 1.529986540000907e-05 1.529986540000907e-05 9.105779871152948e-07 3.030847410001596e-36];

%Zeroforce_PCS_BER
sc_8_Zeroforce_PCS_BER  =[0 0 0 0 3.0000000000000018];
ber_8_Zeroforce_PCS_BER =[0.0037999009907509827 0.0037999175457725707 0.0037999175457725707 0.0037999175457725707  0.0037987715866857424 0.0037987715866857424  0.0037987715866857424 0.0022579731648543918 0.00023282548361632405 7.122955179321993e-06 3.1365076570890996e-08 6.580489343315069e-12 1.0913460823251749e-17 8.620172778333431e-27 3.6658281481748377e-41 6.994936466098275e-64 7.806821087539599e-100 9.404251911798436e-157 6.599752153213219e-247 0.0];
sc_16_Zeroforce_PCS_BER =[0 0 0 0 0 0 0 0 0 0 4 4 4 4 4 4 4 4 4 4];
ber_16_Zeroforce_PCS_BER=[0 0 0 0 0 0 0 0 0 0 0 0.00370655158216107  0.0035236325777362595 0.0010410100708115096  6.30877365235986e-05 0.00012130597764284432 2.0349805658942916e-08 1.8247157233022165e-05 1.529986540000907e-05 1.529986540000907e-05 9.105779871152948e-07 3.030847410001596e-36];


% sc_8  =[1.06203578855088057 1.3098282853966886 1.6138554399575504  1.8707557454517096 2.0707557454517096 2.232345910433167 2.456814657742355 3.0007344150943114 2.9995989882987906 2.999252752606183 3.000745419563752 3.00120786683246 3.0002256044612143 3.001307513713516 3.000421813649949 3.0007077345910913 3.0007309301587695  3.000978763778926 3.0003037596040723 2.9999220766862393];
% ber_8 =[0.0037999009907509827 0.0037999175457725707 0.0037999175457725707 0.0037999175457725707  0.0037987715866857424 0.0037987715866857424  0.0037987715866857424 0.0022579731648543918 0.00023282548361632405 7.122955179321993e-06 3.1365076570890996e-08 6.580489343315069e-12 1.0913460823251749e-17 8.620172778333431e-27 3.6658281481748377e-41 6.994936466098275e-64 7.806821087539599e-100 9.404251911798436e-157 6.599752153213219e-247 0.0];
% sc_16 =[0 0 0 0 0 1.8251954955124834 2.158708337549013 2.458708337549013 2.98216089124173 3.362058129437629 3.9983527199378313 3.997130595846011  3.999154866756651 4.000184200255106 3.9998437614531728 4.002997989494856 3.9989629576212864 3.9997780491591204  3.9997624687474773 3.9992056232335047];
% 
% ber_16=[0.036827201018327184 0.0708008153684416  0.025639775253654233  0.05132044431680988 0.02896145402546188 0.0037994501280689866 0.003799807044591788  0.003799807044591788 0.003799807044591788 0.003793757333556025 0.003073428598154997 0.00042327695994416955 1.9982913519050125e-05 1.7678031181466463e-07 1.1072626789335092e-10 1.0513600481057213e-15  1.3067195830963534e-23 4.41046671740787e-36 8.594611925807303e-56  5.634627481861198e-87];
% 
% 
% sc_8_uni  =[0 0 0 0 3.0000000000000018];
% ber_8_uni =[0.0037999009907509827 0.0037999175457725707 0.0037999175457725707 0.0037999175457725707  0.0037987715866857424 0.0037987715866857424  0.0037987715866857424 0.0022579731648543918 0.00023282548361632405 7.122955179321993e-06 3.1365076570890996e-08 6.580489343315069e-12 1.0913460823251749e-17 8.620172778333431e-27 3.6658281481748377e-41 6.994936466098275e-64 7.806821087539599e-100 9.404251911798436e-157 6.599752153213219e-247 0.0];
% sc_16_uni =[0 0 0 0 0 0 0 0 0 0 4 4 4 4 4 4 4 4 4 4];
% 
% ber_16_uni=[0 0 0 0 0 0 0 0 0 0 0 0.00370655158216107  0.0035236325777362595 0.0010410100708115096  6.30877365235986e-05 0.00012130597764284432 2.0349805658942916e-08 1.8247157233022165e-05 1.529986540000907e-05 1.529986540000907e-05 9.105779871152948e-07 3.030847410001596e-36];
% f = fit(power2,sc_16','smoothingspline','SmoothingParam',0.182242591);
% coeffs = coeffvalues(f);
% sc_16= coeffs.coefs(:,4);
% 
% f = fit(power2,sc_8','smoothingspline','SmoothingParam',0.182242591);
% coeffs = coeffvalues(f);
% sc_8= coeffs.coefs(:,4);
% 
% f = fit(power2,ber_8','smoothingspline','SmoothingParam',0.182242591);
% coeffs = coeffvalues(f);
% ber_8= coeffs.coefs(:,4);
% 
% f = fit(power2,ber_16','smoothingspline','SmoothingParam',0.182242591);
% coeffs = coeffvalues(f);
% ber_16= coeffs.coefs(:,4);

figure1 = figure;
% Change default axes fonts.
set(0,'DefaultAxesFontName', 'Times New Roman')
set(0,'DefaultAxesFontSize', 14)

subplot1 = subplot(1,4,1,'Parent',figure1);
hold(subplot1,'on');
plot(power4,sc_8,'b--o');
% hold on
xlim([15 35])
ylim([0 4.5])
grid on
xlabel('Optical power (dBm)');
ylabel('Secrecy Capacity (bits/s/Hz)');



% figure;
subplot2 = subplot(1,4,2,'Parent',figure1);
hold(subplot2,'on');
plot(power4,ber_8,'b--o');
hold on
grid on
xlim([15 35])

xlabel('Optical power (dBm)');
ylabel('BER');

subplot3 = subplot(1,4,3,'Parent',figure1);
hold(subplot3,'on');
plot(power4,sc_16,'b--o');
% legend('8-PAM','16-PAM');
grid on
xlim([20 35])
ylim([0 4.5])
xlabel('Optical power (dBm)');
ylabel('Secrecy Capacity (bits/s/Hz)');


subplot4 = subplot(1,4,4,'Parent',figure1);
hold(subplot4,'on');
semilogy(power4,ber_16,'b--o');
% legend('8-PAM','16-PAM');
grid on
xlim([20 35])
ylim([-inf 4*10^-3])
xlabel('Optimal power (dBm)');
ylabel('BER');